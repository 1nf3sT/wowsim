<html>
    <head>
        <title>TBC Elemental Simulator</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="uikit.min.css" />

        <script src="wasm_exec.js"></script>
        <script src="uikit.min.js"></script>
        <script src="uikit-icons.min.js"></script>
        <script src="ui.js"></script>
        <link rel="stylesheet" href="ui.css" />
    </head>
    <body>
        <div id="root">
            <h4>TBC Elemental Shaman Simulator</h4>
            <ul id="inputtabs" uk-tab="connect: #inputdata;swiping" >
                <li class="uk-active"><a href="#">Gear</a></li>
                <li><a href="#">Talents</a></li>
                <li><a href="#">Buffs</a></li>
                <li><a href="#">Notes</a></li>
            </ul>
            <ul id="inputdata" class="uk-switcher uk-margin">
                <li id="gear" style="height: 50%;overflow: auto; overflow-x:hidden;min-height: 400px;">
                    <div class="uk-grid-small uk-child-width-expand@s uk-text-center" uk-grid>
                        <div style="min-width: 330px">
                            <div class="uk-grid-small uk-child-width-expand@s uk-text-center" uk-grid>
                                <div id="gearleft">
                                </div>
                            </div>
                        </div>
                        <div style="min-width: 330px">
                            <div class="uk-grid-small uk-child-width-expand@s uk-text-center" uk-grid>
                                <div id="gearright">
                                </div>
                            </div>
                        </div>
                        <div style="min-width: 250px">
                            <div id="gearstats">
                                <table>
                                    <tr><th>Stat</th><th>Gear</th><th><label title="Base + Talents + Gear + Buffs">Final</label></th></tr>
                                    <tr><td><label>Int</label></td> <td><label id="statint">0</label></td><td><label id="fstatint">0</label></td></tr>
                                    <tr><td><label>Stm</label></td> <td><label id="statstm">0</label></td><td><label id="fstatstm">0</label></td></tr>
                                    <tr><td><label title="Includes crit from int on gear.">SpellCrit*</label></td> <td><label id="statspellcrit" title="Includes crit from INT">0</label></td><td><label id="fstatspellcrit" >0</label></td></tr>
                                    <tr><td><label>SpellHit</label></td> <td><label id="statspellhit">0</label></td><td><label id="fstatspellhit">0</label></td></tr>
                                    <tr><td><label>SpellDmg</label></td> <td><label id="statspelldmg">0</label></td><td><label id="fstatspelldmg">0</label></td></tr>
                                    <tr><td><label>Haste</label></td> <td><label id="stathaste">0</label></td><td><label id="fstathaste">0</label></td></tr>
                                    <tr><td><label>MP5</label></td> <td><label id="statmp5">0</label></td><td><label id="fstatmp5">0</label></td></tr>
                                    <tr><td><label>Mana</label></td> <td><label id="statmana" title="This is just bonus mana from gear (int), does not include base.">0</label></td><td><label id="fstatmana">0</label></td></tr>
                                    <tr><td><label>SpellPen</label></td> <td><label id="statspellpen">0</label></td><td><label id="fstatspellpen">0</label></td></tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </li>
                <li id="talents" style="height: 50%;overflow: auto;">
                    <h4>Standard Elemental Build</h4>
                    <b>Elemental:</b> Convection, Concussion, Call of Thunder, Elemental Focus, Elemental Fury, Lightning Mastery, UnrelentingStorm(3/5), Elemental Mastery, Lightning Overload, Totem of Wrath<br />
                    <b>Resto:</b> Natures Guidance, Tidal Mastery<br />
                </li>
                <li id="buffs" style="height: 50%;overflow: auto;">
                    <div class="uk-margin uk-grid-small uk-child-width-auto uk-grid" style="height: 50%"> 
                        <div class="uk-margin uk-grid-small uk-child-width-auto uk-grid buffs" style=>
                            <b style="width: 100%;text-align: right;font-size: 0.7em;color: #1e87f0;">Raid Buffs</b>
                            <label><input id="buffai" class="uk-checkbox" type="checkbox" checked>Arcane Int</label>
                            <label><input id="buffgotw" class="uk-checkbox" type="checkbox" checked>Gift of the Wild</label>
                            <label><input id="buffbk" class="uk-checkbox" type="checkbox" checked>Blessing of Kings</label>
                            <label><input id="buffibow" class="uk-checkbox" type="checkbox" checked>Improved Blessing of Wisdom</label>
                        </div>
                        <div class="uk-margin uk-grid-small uk-child-width-auto uk-grid buffs" style=>
                                <b style="width: 100%;text-align: right;font-size: 0.7em;color: #1e87f0;">Party Buffs</b>
                                <label><input id="buffmoon" class="uk-checkbox" type="checkbox">Moonkin Aura</label>
                                <label>Bloodlust: <select id="buffbl" class="buffdrop" style="width: 50px" value="1">
                                    <option class="buffdrop">0</option>
                                    <option class="buffdrop" selected>1</option>
                                    <option class="buffdrop">2</option>
                                    <option class="buffdrop">3</option>
                                    <option class="buffdrop">4</option>
                                    <option class="buffdrop">5</option>
                                </select></label>
                                <label>Shadow Priest DPS: <input id="buffspriest" class="uk-textbox buffdrop" type="text" style="width: 40px" value="0"></label>
                        </div>
                        <div class="uk-margin uk-grid-small uk-child-width-auto uk-grid buffs" style=>
                            <b style="width: 100%;text-align: right;font-size: 0.7em;color: #1e87f0;">Self Buffs</b>
                            <label><input id="sbufws" class="uk-checkbox" type="checkbox" checked>Water Shield</label>
                        </div>

                        <div class="uk-margin uk-grid-small uk-child-width-auto uk-grid buffs" style=>
                            <b style="width: 100%;text-align: right;font-size: 0.7em;color: #1e87f0;">Target Debuffs</b>
                            <label><input id="debuffjow" class="uk-checkbox" type="checkbox" checked>Judgement of Wisdom</label>
                        </div>

                        <div class="uk-margin uk-grid-small uk-child-width-auto uk-grid buffs" style=>
                            <b style="width: 100%;text-align: right;font-size: 0.7em;color: #1e87f0;">Consumes</b>
                            <label><input id="confbl" class="uk-checkbox" type="checkbox">Flask of Blinding Light</label>
                            <label><input id="confmr" class="uk-checkbox" type="checkbox">Flask of Mighty Restoration</label>
                            <label><input id="conbwo" class="uk-checkbox" type="checkbox" checked>Brilliant Wizard Oil</label>
                            <label><input id="conmm" class="uk-checkbox" type="checkbox" checked>Major Mageblood</label>
                            <label><input id="conbb" class="uk-checkbox" type="checkbox">Blacked Basalisk</label>
                            <label><input id="consmp" class="uk-checkbox" type="checkbox" checked>Super Mana Potion</label>
                            <label><input id="condr" class="uk-checkbox" type="checkbox" checked>Dark Rune</label>        
                        </div>
                        <div class="uk-margin uk-grid-small uk-child-width-auto uk-grid buffs" style=>
                            <b style="width: 100%;text-align: right;font-size: 0.7em;color: #1e87f0;">Totems</b>
                            <label><input id="totms" class="uk-checkbox" type="checkbox" checked>Mana Spring</label>
                            <label><input id="totwoa" class="uk-checkbox" type="checkbox" checked>Wrath of Air</label>
                            <label>Totem of Wrath: <select id="totwr" class="buffdrop" list="ttwv" style="width: 50px" value="1">
                                <option class="buffdrop">0</option>
                                <option class="buffdrop" selected>1</option>
                                <option class="buffdrop">2</option>
                                <option class="buffdrop">3</option>
                                <option class="buffdrop">4</option>
                                <option class="buffdrop">5</option>
                            </select></label>
                        </div>
                    </div>
                </li>
                <li id="notes" style="height: 50%;overflow: auto;">
                    <ul>
                        <li>All activatable abilities and items are activated on CD (usually at the start of fight).</li>
                        <li>Gems and gemming bonuses are not implemented.</li>
                        <li>Set bonuses are not implemented.</li>
                        <li>Unsure of exact spell pen. Using classic 2.5% chance for a 25% partial resist (this is probably wrong).</li>
                        <li>The 'optimize' checkbox in the simulation tab will figure out a rotation that maximizes DPS for the given duration.</li>
                        <li>The 'Hasted Rotations' tab will calculate the max DPS rotation for the given gear set and at fixed haste levels.</li>
                    </ul>
                </li>
            </ul>
            <div id="calcdiv">
                <ul id="calctabs" uk-tab="connect: #calcs">
                    <li class="uk-active"><a href="#">Sim</a></li>
                    <li><a href="#">Histogram</a></li>
                    <li><a href="#">Hasted Rotations</a></li>
                </ul>
                <ul id="calcs" class="uk-switcher uk-margin">
                    <li>
                        <div style="text-align: right">
                            <button onclick="runsim();">Run Simulation</button>
                            Iterations: <input id="iters" type="text" value="1000" style="width: 60px"></input>
                            Duration: <input id="dur" type="text" value="300" style="width: 60px"></input>
                            Optimize: <input id="doopt" type="checkbox" class="uk-checkbox" checked></input>
                        </div>
                        <div id="output1" style="overflow: auto; top: 0px; bottom: 0px;"></div>
                        <div id="output2" style="overflow: auto; top: 0px; bottom: 0px;"></div>
                    </li>
                    <li style="height: 35%">
                        DPS Histogram
                    </li>
                    <li style="height: 35%">
                        <div style="text-align: right;">
                            <button onclick="hastedRotations();">Optimize Haste Rotation</button>
                        </div>
                        <ul>
                            <li>Does not use bloodlust (ignores BL settings above)</li>
                            <li>Uses all other options, but replaces the haste stat.</li>
                            <li>Do not recommend using Quags Eye</li>
                            <li>Not mana optimized, this is showing max dps for a 60s fight</li>
                            <li>Even a very small amount of haste like 20 makes CL / 4LB > CL / 3LB</li>
                        </ul>
                        <div id="hasterots">
                            <table class="hastetable">
                                <tr><th>Haste</th><th>Rotation</th><th>DPS</th></tr>
                                <tr><td></td><td></td><td></td></tr>
                                <tr><td></td><td></td><td></td></tr>
                                <tr><td></td><td></td><td></td></tr>
                                <tr><td></td><td></td><td></td></tr>
                                <tr><td></td><td></td><td></td></tr>
                                <tr><td></td><td></td><td></td></tr>
                                <tr><td></td><td></td><td></td></tr>
                                <tr><td></td><td></td><td></td></tr>
                            </table>
                        </div>
                    </li>
                </ul>    
            </div>
        </div>
    </body>
</html>
